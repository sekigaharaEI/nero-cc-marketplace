# daemon-archon 开发接续提示词

请将以下内容复制粘贴给新的 Claude Code 会话，以接续 daemon-archon 插件的开发工作。

---

## 接续对话提示词

我正在开发一个 Claude Code 插件，名为 **daemon-archon（守护进程执政官）**。

### 项目背景

这是一个提供守护进程和定时任务功能的 Claude Code 插件，支持两种工作模式：

1. **Probe 模式**：Archon（执政官）启动并监控一个 Probe（探机，子 Claude Code CLI）执行长期任务（如代码重构、长期开发），可进行状态分析和纠偏
2. **Cron 模式**：定时启动临时 Claude Code CLI 执行周期性任务（如日志检查、状态巡检），分析结果并按需通知用户

### 核心角色

- **Claude Code 终端**：基础执行环境，加载插件/skills/commands
- **Archon（执政官）**：任务调度器，基于系统 cron 实现定时调度
- **Probe（探机）**：执行层角色，基于 Claude Code CLI 运行，接受 Archon 调度和纠偏

### 相关文档位置

请先阅读以下文档了解完整设计：

1. **设计文档**：`/home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/design.md`
   - 包含：两种模式的核心流程、架构方案、功能点拆解、命令体系、数据模型、实现计划

2. **开发设计文档**：`/home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/dev_design.md`
   - 包含：架构角色定义、工作目录结构、文件说明、日志格式规范、设计决策记录

3. **原始需求**：`/home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/ori_request.md`
   - 包含：用户原始描述、需求拆解、两种模式对比

### 已完成的设计决策

**决策 #1：工作目录结构**
```
.claude/daemon-archon/
├── setting.json                          # 全局配置（通知方式等）
├── 20260201_143000_probe/                # Probe 任务目录（时间戳+模式后缀）
│   ├── config.json                       # 任务配置
│   ├── status                            # 状态文件（active/stopped/paused）
│   ├── corrections.md                    # 纠偏历史（Markdown 格式）
│   └── archon.log                        # 工作日志（带时间戳）
│
└── 20260201_150000_cron/                 # Cron 任务目录（时间戳+模式后缀）
    ├── config.json                       # 任务配置
    ├── status                            # 状态文件（active/stopped/paused）
    ├── task.md                           # 任务描述/提示词/背景/特别说明
    ├── workflow/                         # Workflow 子文件夹
    │   ├── workflow.md                   # 工作流程定义
    │   └── scripts/                      # 脚本代码（可选）
    └── archon.log                        # 工作日志（带时间戳）
```

### 待讨论/待设计的问题

1. **全局配置 `setting.json`** 需要包含哪些内容？（通知方式、默认间隔...）
2. 是否需要 **锁文件** 防止并发执行？
3. **corrections.md** 的具体格式？
4. **config.json** 的具体字段？

### 当前开发阶段

我们正处于**开发设计阶段**，需要继续细化以下内容：
- 各配置文件的具体字段定义
- 纠偏历史的 Markdown 格式
- 全局配置的内容

### 请求

请先阅读上述三个文档，然后我们继续讨论待设计的问题。每次有确定的结论时，请记录到 `dev_design.md` 的设计决策记录中。

---

## 快速命令

```bash
# 查看设计文档
cat /home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/design.md

# 查看开发设计文档
cat /home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/dev_design.md

# 查看原始需求
cat /home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/ori_request.md
```

---

## 注意事项

- 使用 **Archon（执政官）** 称呼调度器/观察者
- 使用 **Probe（探机）** 称呼执行者
- 不要提及这些名称的游戏来源
- 每次有设计决策时，记录到 `dev_design.md`
- 开发文档路径：`/home/zyw/project/nero-cc-marketplace/docs/daemon-archon/dev/`
