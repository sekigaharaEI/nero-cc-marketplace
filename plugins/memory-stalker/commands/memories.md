---
description: 交互式浏览和选择记忆文件 - Memory Stalker 记忆追猎者
---

<memories>

# Memories - 记忆浏览器

列出所有可用的记忆文件，让用户选择要加载的记忆。

## 使用方式

| 命令 | 说明 |
|------|------|
| `/memories` | 列出所有记忆文件 |

## 执行指令

当用户调用此命令时，请按以下步骤执行：

### 步骤 1: 获取记忆文件列表

使用 Bash 工具运行以下命令获取所有记忆文件：

```bash
python ${CLAUDE_PROJECT_DIR}/plugins/memory-stalker/scripts/list_memories.py "${CLAUDE_PROJECT_DIR}" --json
```

注意：如果插件是通过 marketplace 安装的，脚本路径可能在 `~/.claude/plugins/cache/nero-cc-marketplace/memory-stalker/*/scripts/` 下。

### 步骤 2: 展示记忆列表

将结果以表格形式展示给用户：

```markdown
## 可用的记忆文件

| # | 日期 | Session | 任务数 | 摘要 |
|---|------|---------|--------|------|
| 1 | 2026-01-29 17:30 | ff246da3 | 5 | 完成了 XXX... |
| 2 | 2026-01-29 15:00 | abc12345 | 3 | 实现了 YYY... |
| ... | ... | ... | ... | ... |

共 {N} 个记忆文件
```

### 步骤 3: 让用户选择

如果有记忆文件，使用 AskUserQuestion 让用户选择：

```
请选择要加载的记忆文件：
- 选项 1: {第一个记忆的日期和摘要}
- 选项 2: {第二个记忆的日期和摘要}
- 选项 3: {第三个记忆的日期和摘要}
- 选项 4: 查看更多
```

注意：AskUserQuestion 最多支持 4 个选项，如果记忆文件超过 3 个，第 4 个选项应该是"查看更多"或"输入序号"。

### 步骤 4: 加载选中的记忆

用户选择后：
1. 使用 Read 工具读取对应的记忆文件
2. 展示记忆内容摘要
3. 询问用户是否继续之前的任务

### 步骤 5: 展示记忆内容

加载记忆后，向用户展示以下信息：

```markdown
## 已加载记忆: {文件名}

**日期**: {日期}
**Session ID**: {session_id}

### 最后一轮交互
{展示最后一轮交互的内容}

### 当前任务列表
{展示任务列表}

### AI 摘要
{展示 AI 生成的摘要}
```

### 步骤 6: 询问后续操作

使用 AskUserQuestion 询问用户：

```
已加载记忆文件，你想要：
1. 继续未完成的任务
2. 查看完整记忆内容
3. 加载其他记忆文件
4. 开始新的任务
```

## 特殊情况处理

### 没有记忆文件

如果 `.claude/memories/` 目录不存在或为空：

```markdown
## 没有找到记忆文件

当前项目还没有保存过记忆。记忆会在以下情况自动保存：
- 上下文自动压缩时（PreCompact Hook）
- 手动执行 `/compact` 命令时

记忆文件存储在: `{项目路径}/.claude/memories/`
```

### 只有一个记忆文件

如果只有一个记忆文件，直接加载并展示，不需要让用户选择。

## 注意事项

- 记忆文件按时间倒序排列，最新的在最前面
- 表格中的摘要会被截断，完整内容需要读取文件
- 任务数是从记忆文件中统计的 `- [x]` 和 `- [ ]` 格式的条目

</memories>
